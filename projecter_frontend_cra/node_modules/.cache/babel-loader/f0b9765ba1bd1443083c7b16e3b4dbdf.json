{"ast":null,"code":"import axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { LOG_IN, USER_DATA } from \"../containers/Constant\";\n\nconst loginAction = credentials => async dispatch => {\n  try {\n    var _user$data, _user$data$user;\n\n    const response = await axios.post(\"http://localhost:3000/auth/login\", credentials);\n    sessionStorage.setItem(\"token\", response.data.token);\n    const user = await axios.get(\"http://localhost:3000/user/getone\", {\n      headers: {\n        Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n      }\n    });\n    const userData = {\n      role: user === null || user === void 0 ? void 0 : (_user$data = user.data) === null || _user$data === void 0 ? void 0 : (_user$data$user = _user$data.user) === null || _user$data$user === void 0 ? void 0 : _user$data$user.role\n    };\n    sessionStorage.setItem(\"user\", JSON.stringify(userData));\n    await dispatch({\n      type: LOG_IN,\n      payload: response.data\n    }); // response.data has {status and token}.\n\n    await dispatch({\n      type: USER_DATA,\n      payload: user.data.user\n    });\n  } catch (err) {\n    var _err$response, _err$response$data, _err$response2, _err$response2$data;\n\n    if ((err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.msg) === \"Could not find email\") {\n      toast.error(\"Invalid email address\");\n    } else if ((err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.msg) === \"Incorrect password\") {\n      toast.error(\"Incorrect password\");\n    }\n  }\n};\n\nexport default loginAction;","map":{"version":3,"names":["axios","toast","LOG_IN","USER_DATA","loginAction","credentials","dispatch","response","post","sessionStorage","setItem","data","token","user","get","headers","Authorization","getItem","userData","role","JSON","stringify","type","payload","err","msg","error"],"sources":["/Users/csuftitan/Downloads/Projecter/projecter_frontend_cra/src/redux/actions/LoginAction.js"],"sourcesContent":["import axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { LOG_IN, USER_DATA } from \"../containers/Constant\";\n\nconst loginAction = (credentials) => async (dispatch) => {\n  try {\n    const response = await axios.post(\n      \"http://localhost:3000/auth/login\",\n      credentials\n    );\n\n    sessionStorage.setItem(\"token\", response.data.token);\n\n    const user = await axios.get(\"http://localhost:3000/user/getone\", {\n      headers: { Authorization: `Bearer ${sessionStorage.getItem(\"token\")}` },\n    });\n\n    const userData = {\n      role: user?.data?.user?.role,\n    };\n\n    sessionStorage.setItem(\"user\", JSON.stringify(userData));\n\n    await dispatch({ type: LOG_IN, payload: response.data }); // response.data has {status and token}.\n    await dispatch({ type: USER_DATA, payload: user.data.user });\n  } catch (err) {\n    if (err?.response?.data?.msg === \"Could not find email\") {\n      toast.error(\"Invalid email address\");\n    } else if (err?.response?.data?.msg === \"Incorrect password\") {\n      toast.error(\"Incorrect password\");\n    }\n  }\n};\n\nexport default loginAction;\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,MAAT,EAAiBC,SAAjB,QAAkC,wBAAlC;;AAEA,MAAMC,WAAW,GAAIC,WAAD,IAAiB,MAAOC,QAAP,IAAoB;EACvD,IAAI;IAAA;;IACF,MAAMC,QAAQ,GAAG,MAAMP,KAAK,CAACQ,IAAN,CACrB,kCADqB,EAErBH,WAFqB,CAAvB;IAKAI,cAAc,CAACC,OAAf,CAAuB,OAAvB,EAAgCH,QAAQ,CAACI,IAAT,CAAcC,KAA9C;IAEA,MAAMC,IAAI,GAAG,MAAMb,KAAK,CAACc,GAAN,CAAU,mCAAV,EAA+C;MAChEC,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASP,cAAc,CAACQ,OAAf,CAAuB,OAAvB,CAAgC;MAA3D;IADuD,CAA/C,CAAnB;IAIA,MAAMC,QAAQ,GAAG;MACfC,IAAI,EAAEN,IAAF,aAAEA,IAAF,qCAAEA,IAAI,CAAEF,IAAR,kEAAE,WAAYE,IAAd,oDAAE,gBAAkBM;IADT,CAAjB;IAIAV,cAAc,CAACC,OAAf,CAAuB,MAAvB,EAA+BU,IAAI,CAACC,SAAL,CAAeH,QAAf,CAA/B;IAEA,MAAMZ,QAAQ,CAAC;MAAEgB,IAAI,EAAEpB,MAAR;MAAgBqB,OAAO,EAAEhB,QAAQ,CAACI;IAAlC,CAAD,CAAd,CAlBE,CAkBwD;;IAC1D,MAAML,QAAQ,CAAC;MAAEgB,IAAI,EAAEnB,SAAR;MAAmBoB,OAAO,EAAEV,IAAI,CAACF,IAAL,CAAUE;IAAtC,CAAD,CAAd;EACD,CApBD,CAoBE,OAAOW,GAAP,EAAY;IAAA;;IACZ,IAAI,CAAAA,GAAG,SAAH,IAAAA,GAAG,WAAH,6BAAAA,GAAG,CAAEjB,QAAL,sFAAeI,IAAf,0EAAqBc,GAArB,MAA6B,sBAAjC,EAAyD;MACvDxB,KAAK,CAACyB,KAAN,CAAY,uBAAZ;IACD,CAFD,MAEO,IAAI,CAAAF,GAAG,SAAH,IAAAA,GAAG,WAAH,8BAAAA,GAAG,CAAEjB,QAAL,yFAAeI,IAAf,4EAAqBc,GAArB,MAA6B,oBAAjC,EAAuD;MAC5DxB,KAAK,CAACyB,KAAN,CAAY,oBAAZ;IACD;EACF;AACF,CA5BD;;AA8BA,eAAetB,WAAf"},"metadata":{},"sourceType":"module"}